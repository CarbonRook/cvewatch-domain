package vulnerability

import (
	"net/url"
	"time"
)

type Vulnerability struct {
	CveId         string      `json:"cveId"`
	Assigner      string      `json:"assigner"`
	Description   string      `json:"description"`
	PublishedDate time.Time   `json:"publishedDate"`
	LastModified  time.Time   `json:"lastModified"`
	BaseMetric3   BaseMetric3 `json:"baseMetric3"`
	Cvss3         Cvss3       `json:"cvss3"`
	BaseMetric2   BaseMetric2 `json:"baseMetric2"`
	Cvss2         Cvss2       `json:"cvss2"`
	Cwes          []Cwe       `json:"cwes"`
	References    []Reference `json:"references"`
}

type BaseMetric3 struct {
	ExploitabilityScore float64 `json:"exploitabilityScore"`
	ImpactScore         float64 `json:"impactScore"`
}

type Cvss3 struct {
	Version               string  `json:"version"`
	CvssVector            string  `json:"cvssVector"`
	AttackVector          string  `json:"attackVector"`
	AttackComplexity      string  `json:"attackComplexity"`
	PrivilegesRequired    string  `json:"privilegesRequired"`
	UserInteraction       string  `json:"userInteraction"`
	Scope                 string  `json:"scope"`
	ConfidentialityImpact string  `json:"confidentialityImpact"`
	IntegrityImpact       string  `json:"integrityImpact"`
	AvailabilityImpact    string  `json:"availabilityImpact"`
	BaseScore             float64 `json:"baseScore"`
	BaseSeverity          string  `json:"baseSeverity"`
}

type BaseMetric2 struct {
	Severity                string  `json:"severity"`
	ExploitabilityScore     float64 `json:"exploitabilityScore"`
	ImpactScore             float64 `json:"impactScore"`
	AcInsuffInfo            bool    `json:"acInsuffInfo"`
	ObtainAllPrivilege      bool    `json:"obtainAllPrivilege"`
	ObtainUserPrivilege     bool    `json:"obtainUserPrivilege"`
	ObtainOtherPrivilege    bool    `json:"obtainOtherPrivilege"`
	UserInteractionRequired bool    `json:"userInteractionRequired"`
}

type Cvss2 struct {
	Version               string  `json:"version"`
	CvssVector            string  `json:"cvssVector"`
	AccessVector          string  `json:"accessVector"`
	AccessComplexity      string  `json:"accessComplexity"`
	Authentication        string  `json:"authentication"`
	ConfidentialityImpact string  `json:"confidentialityImpact"`
	IntegrityImpact       string  `json:"integrityImpact"`
	AvailabilityImpact    string  `json:"availabilityImpact"`
	BaseScore             float64 `json:"baseScore"`
}

type Cwe struct {
	Id string `json:"id"`
}

type Reference struct {
	Url    url.URL  `json:"url"`
	Name   string   `json:"name"`
	Source string   `json:"source"`
	Tags   []string `json:"tags"`
}

type VulnerabilityCollection struct {
	Vulnerabilities []Vulnerability `json:"vulnerabilities"`
}
